8 1104
Now sampling at 100 timeslots.
Now sampling at 200 timeslots.
Now sampling at 300 timeslots.
Now sampling at 400 timeslots.
Now sampling at 500 timeslots.
Now sampling at 600 timeslots.
Now sampling at 700 timeslots.
Now sampling at 800 timeslots.
Now sampling at 900 timeslots.
Now sampling at 1000 timeslots.
Now sampling at 1100 timeslots.
min: 0.0 max: 281.0
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
nbhd_volume_input_time_1 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_2 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_3 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_4 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_5 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_6 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_7 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_8 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_convs_time0_1 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_1[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_2 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_2[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_3 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_3[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_4 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_4[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_5 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_5[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_6 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_6[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_7 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_7[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_8 (Conv2D)     (None, 1, 7, 64)     4096        nbhd_volume_input_time_8[0][0]   
__________________________________________________________________________________________________
nbhd_convs_activation_time0_1 ( (None, 1, 7, 64)     0           nbhd_convs_time0_1[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_2 ( (None, 1, 7, 64)     0           nbhd_convs_time0_2[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_3 ( (None, 1, 7, 64)     0           nbhd_convs_time0_3[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_4 ( (None, 1, 7, 64)     0           nbhd_convs_time0_4[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_5 ( (None, 1, 7, 64)     0           nbhd_convs_time0_5[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_6 ( (None, 1, 7, 64)     0           nbhd_convs_time0_6[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_7 ( (None, 1, 7, 64)     0           nbhd_convs_time0_7[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_8 ( (None, 1, 7, 64)     0           nbhd_convs_time0_8[0][0]         
__________________________________________________________________________________________________
nbhd_convs_time1_1 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_1[0][
__________________________________________________________________________________________________
nbhd_convs_time1_2 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_2[0][
__________________________________________________________________________________________________
nbhd_convs_time1_3 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_3[0][
__________________________________________________________________________________________________
nbhd_convs_time1_4 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_4[0][
__________________________________________________________________________________________________
nbhd_convs_time1_5 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_5[0][
__________________________________________________________________________________________________
nbhd_convs_time1_6 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_6[0][
__________________________________________________________________________________________________
nbhd_convs_time1_7 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_7[0][
__________________________________________________________________________________________________
nbhd_convs_time1_8 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time0_8[0][
__________________________________________________________________________________________________
nbhd_convs_activation_time1_1 ( (None, 1, 7, 64)     0           nbhd_convs_time1_1[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_2 ( (None, 1, 7, 64)     0           nbhd_convs_time1_2[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_3 ( (None, 1, 7, 64)     0           nbhd_convs_time1_3[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_4 ( (None, 1, 7, 64)     0           nbhd_convs_time1_4[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_5 ( (None, 1, 7, 64)     0           nbhd_convs_time1_5[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_6 ( (None, 1, 7, 64)     0           nbhd_convs_time1_6[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_7 ( (None, 1, 7, 64)     0           nbhd_convs_time1_7[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_8 ( (None, 1, 7, 64)     0           nbhd_convs_time1_8[0][0]         
__________________________________________________________________________________________________
nbhd_convs_time2_1 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_1[0][
__________________________________________________________________________________________________
nbhd_convs_time2_2 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_2[0][
__________________________________________________________________________________________________
nbhd_convs_time2_3 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_3[0][
__________________________________________________________________________________________________
nbhd_convs_time2_4 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_4[0][
__________________________________________________________________________________________________
nbhd_convs_time2_5 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_5[0][
__________________________________________________________________________________________________
nbhd_convs_time2_6 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_6[0][
__________________________________________________________________________________________________
nbhd_convs_time2_7 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_7[0][
__________________________________________________________________________________________________
nbhd_convs_time2_8 (Conv2D)     (None, 1, 7, 64)     36928       nbhd_convs_activation_time1_8[0][
__________________________________________________________________________________________________
nbhd_convs_activation_time2_1 ( (None, 1, 7, 64)     0           nbhd_convs_time2_1[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_2 ( (None, 1, 7, 64)     0           nbhd_convs_time2_2[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_3 ( (None, 1, 7, 64)     0           nbhd_convs_time2_3[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_4 ( (None, 1, 7, 64)     0           nbhd_convs_time2_4[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_5 ( (None, 1, 7, 64)     0           nbhd_convs_time2_5[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_6 ( (None, 1, 7, 64)     0           nbhd_convs_time2_6[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_7 ( (None, 1, 7, 64)     0           nbhd_convs_time2_7[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_8 ( (None, 1, 7, 64)     0           nbhd_convs_time2_8[0][0]         
__________________________________________________________________________________________________
nbhd_flatten_time_1 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_1[0][
__________________________________________________________________________________________________
nbhd_flatten_time_2 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_2[0][
__________________________________________________________________________________________________
nbhd_flatten_time_3 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_3[0][
__________________________________________________________________________________________________
nbhd_flatten_time_4 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_4[0][
__________________________________________________________________________________________________
nbhd_flatten_time_5 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_5[0][
__________________________________________________________________________________________________
nbhd_flatten_time_6 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_6[0][
__________________________________________________________________________________________________
nbhd_flatten_time_7 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_7[0][
__________________________________________________________________________________________________
nbhd_flatten_time_8 (Flatten)   (None, 448)          0           nbhd_convs_activation_time2_8[0][
__________________________________________________________________________________________________
nbhd_dense_time_1 (Dense)       (None, 128)          57472       nbhd_flatten_time_1[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_2 (Dense)       (None, 128)          57472       nbhd_flatten_time_2[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_3 (Dense)       (None, 128)          57472       nbhd_flatten_time_3[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_4 (Dense)       (None, 128)          57472       nbhd_flatten_time_4[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_5 (Dense)       (None, 128)          57472       nbhd_flatten_time_5[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_6 (Dense)       (None, 128)          57472       nbhd_flatten_time_6[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_7 (Dense)       (None, 128)          57472       nbhd_flatten_time_7[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_8 (Dense)       (None, 128)          57472       nbhd_flatten_time_8[0][0]        
__________________________________________________________________________________________________
nbhd_dense_activation_time_1 (A (None, 128)          0           nbhd_dense_time_1[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_2 (A (None, 128)          0           nbhd_dense_time_2[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_3 (A (None, 128)          0           nbhd_dense_time_3[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_4 (A (None, 128)          0           nbhd_dense_time_4[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_5 (A (None, 128)          0           nbhd_dense_time_5[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_6 (A (None, 128)          0           nbhd_dense_time_6[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_7 (A (None, 128)          0           nbhd_dense_time_7[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_8 (A (None, 128)          0           nbhd_dense_time_8[0][0]          
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 1024)         0           nbhd_dense_activation_time_1[0][0
                                                                 nbhd_dense_activation_time_2[0][0
                                                                 nbhd_dense_activation_time_3[0][0
                                                                 nbhd_dense_activation_time_4[0][0
                                                                 nbhd_dense_activation_time_5[0][0
                                                                 nbhd_dense_activation_time_6[0][0
                                                                 nbhd_dense_activation_time_7[0][0
                                                                 nbhd_dense_activation_time_8[0][0
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 8, 128)       0           concatenate_1[0][0]              
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 128)          131584      reshape_1[0][0]                  
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            129         lstm_1[0][0]                     
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 1)            0           dense_1[0][0]                    
==================================================================================================
Total params: 1,215,105
Trainable params: 1,215,105
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 224460 samples, validate on 56116 samples
Epoch 1/100
2018-04-02 17:14:32.989000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
2018-04-02 17:14:32.989062: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:07:00.0, compute capability: 3.7)
224460/224460 [==============================] - 258s 1ms/step - loss: 0.0059 - val_loss: 0.0028
Epoch 2/100
224460/224460 [==============================] - 272s 1ms/step - loss: 0.0026 - val_loss: 0.0026
Epoch 3/100
224460/224460 [==============================] - 272s 1ms/step - loss: 0.0022 - val_loss: 0.0028
Epoch 4/100
224460/224460 [==============================] - 275s 1ms/step - loss: 0.0021 - val_loss: 0.0021
Epoch 5/100
224460/224460 [==============================] - 282s 1ms/step - loss: 0.0020 - val_loss: 0.0031
Epoch 6/100
224460/224460 [==============================] - 279s 1ms/step - loss: 0.0019 - val_loss: 0.0019
Epoch 7/100
224460/224460 [==============================] - 274s 1ms/step - loss: 0.0018 - val_loss: 0.0019
Epoch 8/100
224460/224460 [==============================] - 272s 1ms/step - loss: 0.0018 - val_loss: 0.0018
Epoch 9/100
224460/224460 [==============================] - 283s 1ms/step - loss: 0.0017 - val_loss: 0.0020
Epoch 10/100
224460/224460 [==============================] - 271s 1ms/step - loss: 0.0017 - val_loss: 0.0025
Epoch 11/100
224460/224460 [==============================] - 275s 1ms/step - loss: 0.0017 - val_loss: 0.0019
Epoch 12/100
224460/224460 [==============================] - 282s 1ms/step - loss: 0.0016 - val_loss: 0.0025
Epoch 13/100
224460/224460 [==============================] - 277s 1ms/step - loss: 0.0016 - val_loss: 0.0020
Epoch 14/100
224460/224460 [==============================] - 275s 1ms/step - loss: 0.0016 - val_loss: 0.0017
Epoch 15/100
224460/224460 [==============================] - 283s 1ms/step - loss: 0.0016 - val_loss: 0.0017
Epoch 16/100
224460/224460 [==============================] - 280s 1ms/step - loss: 0.0015 - val_loss: 0.0016
Epoch 17/100
224460/224460 [==============================] - 281s 1ms/step - loss: 0.0015 - val_loss: 0.0018
Epoch 18/100
224460/224460 [==============================] - 362s 2ms/step - loss: 0.0015 - val_loss: 0.0020
Epoch 19/100
224460/224460 [==============================] - 394s 2ms/step - loss: 0.0015 - val_loss: 0.0017
Epoch 20/100
224460/224460 [==============================] - 538s 2ms/step - loss: 0.0015 - val_loss: 0.0016
Epoch 21/100
224460/224460 [==============================] - 605s 3ms/step - loss: 0.0015 - val_loss: 0.0016
Epoch 22/100
224460/224460 [==============================] - 399s 2ms/step - loss: 0.0015 - val_loss: 0.0016
Epoch 23/100
224460/224460 [==============================] - 356s 2ms/step - loss: 0.0015 - val_loss: 0.0016
Epoch 24/100
224460/224460 [==============================] - 332s 1ms/step - loss: 0.0014 - val_loss: 0.0017
Epoch 25/100
224460/224460 [==============================] - 325s 1ms/step - loss: 0.0014 - val_loss: 0.0016
Epoch 26/100
224460/224460 [==============================] - 512s 2ms/step - loss: 0.0014 - val_loss: 0.0023
Epoch 27/100
224460/224460 [==============================] - 473s 2ms/step - loss: 0.0014 - val_loss: 0.0021
Epoch 28/100
224460/224460 [==============================] - 390s 2ms/step - loss: 0.0014 - val_loss: 0.0017
Epoch 29/100
224460/224460 [==============================] - 336s 1ms/step - loss: 0.0014 - val_loss: 0.0015
Epoch 30/100
224460/224460 [==============================] - 327s 1ms/step - loss: 0.0014 - val_loss: 0.0015
Epoch 31/100
224460/224460 [==============================] - 326s 1ms/step - loss: 0.0014 - val_loss: 0.0015
Epoch 32/100
224460/224460 [==============================] - 335s 1ms/step - loss: 0.0014 - val_loss: 0.0016
Epoch 33/100
224460/224460 [==============================] - 327s 1ms/step - loss: 0.0014 - val_loss: 0.0017
Epoch 34/100
224460/224460 [==============================] - 325s 1ms/step - loss: 0.0014 - val_loss: 0.0016
Epoch 35/100
224460/224460 [==============================] - 344s 2ms/step - loss: 0.0014 - val_loss: 0.0015
Epoch 36/100
224460/224460 [==============================] - 334s 1ms/step - loss: 0.0014 - val_loss: 0.0015
Epoch 37/100
224460/224460 [==============================] - 329s 1ms/step - loss: 0.0013 - val_loss: 0.0016
Epoch 38/100
224460/224460 [==============================] - 334s 1ms/step - loss: 0.0013 - val_loss: 0.0016
Epoch 39/100
224460/224460 [==============================] - 329s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 40/100
224460/224460 [==============================] - 308s 1ms/step - loss: 0.0013 - val_loss: 0.0016
Epoch 41/100
224460/224460 [==============================] - 306s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 42/100
224460/224460 [==============================] - 299s 1ms/step - loss: 0.0013 - val_loss: 0.0018
Epoch 43/100
224460/224460 [==============================] - 320s 1ms/step - loss: 0.0013 - val_loss: 0.0024
Epoch 44/100
224460/224460 [==============================] - 331s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 45/100
224460/224460 [==============================] - 323s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 46/100
224460/224460 [==============================] - 323s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 47/100
224460/224460 [==============================] - 329s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 48/100
224460/224460 [==============================] - 322s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 49/100
224460/224460 [==============================] - 323s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 50/100
224460/224460 [==============================] - 330s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 51/100
224460/224460 [==============================] - 324s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 52/100
224460/224460 [==============================] - 324s 1ms/step - loss: 0.0013 - val_loss: 0.0014
Epoch 53/100
224460/224460 [==============================] - 333s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 54/100
224460/224460 [==============================] - 320s 1ms/step - loss: 0.0013 - val_loss: 0.0016
Epoch 55/100
224460/224460 [==============================] - 329s 1ms/step - loss: 0.0013 - val_loss: 0.0015
Epoch 56/100
224460/224460 [==============================] - 327s 1ms/step - loss: 0.0012 - val_loss: 0.0015
Epoch 57/100
224460/224460 [==============================] - 292s 1ms/step - loss: 0.0012 - val_loss: 0.0016
8 336
Now sampling at 100 timeslots.
Now sampling at 200 timeslots.
Now sampling at 300 timeslots.
min: 0.0 max: 281.0
rmse (norm): 0.040538 rmse (real): 5.695654
5.695654