quyuan@ddst-PowerEdge-R730:~/code$ python Att-ConvLSTM.py 
/home/quyuan/anaconda3/lib/python3.6/site-packages/h5py/__init__.py:36: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  from ._conv import register_converters as _register_converters
Using TensorFlow backend.
2018-04-03 16:22:31.461472: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
2018-04-03 16:22:31.688224: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 0 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:06:00.0
totalMemory: 11.92GiB freeMemory: 9.01GiB
2018-04-03 16:22:31.897762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1030] Found device 1 with properties: 
name: Tesla K80 major: 3 minor: 7 memoryClockRate(GHz): 0.8235
pciBusID: 0000:07:00.0
totalMemory: 11.92GiB freeMemory: 11.67GiB
2018-04-03 16:22:31.897991: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1045] Device peer to peer matrix
2018-04-03 16:22:31.898039: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1051] DMA: 0 1 
2018-04-03 16:22:31.898058: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 0:   Y Y 
2018-04-03 16:22:31.898071: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1061] 1:   Y Y 
2018-04-03 16:22:31.898094: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
2018-04-03 16:22:31.898111: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:07:00.0, compute capability: 3.7)
483 1440
Now sampling at 500 timeslots.
Now sampling at 600 timeslots.
Now sampling at 700 timeslots.
Now sampling at 800 timeslots.
Now sampling at 900 timeslots.
Now sampling at 1000 timeslots.
Now sampling at 1100 timeslots.
Now sampling at 1200 timeslots.
Now sampling at 1300 timeslots.
Now sampling at 1400 timeslots.
min: 0.0 max: 281.0
(9, 244992, 1, 7, 7) (3, 244992, 3, 80) (7, 244992, 1, 7, 7) (244992, 7, 80) (244992, 1)
2018-04-03 16:32:28.734804: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:0) -> (device: 0, name: Tesla K80, pci bus id: 0000:06:00.0, compute capability: 3.7)
2018-04-03 16:32:28.734882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1120] Creating TensorFlow device (/device:GPU:1) -> (device: 1, name: Tesla K80, pci bus id: 0000:07:00.0, compute capability: 3.7)
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
att_nbhd_volume_input_time_1_1  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_2_1  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_3_1  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_1 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_2 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_3 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_4 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_5 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_6 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
nbhd_volume_input_time_7 (Input (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_1_2  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_2_2  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_3_2  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_1_3  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_2_3  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_volume_input_time_3_3  (None, 1, 7, 7)      0                                            
__________________________________________________________________________________________________
att_nbhd_convs_time0_1_1 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_1_1[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_1_2 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_2_1[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_1_3 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_3_1[0]
__________________________________________________________________________________________________
nbhd_convs_time0_1 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_1[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_2 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_2[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_3 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_3[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_4 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_4[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_5 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_5[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_6 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_6[0][0]   
__________________________________________________________________________________________________
nbhd_convs_time0_7 (Conv2D)     (None, 64, 7, 7)     640         nbhd_volume_input_time_7[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_time0_2_1 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_1_2[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_2_2 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_2_2[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_2_3 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_3_2[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_3_1 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_1_3[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_3_2 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_2_3[0]
__________________________________________________________________________________________________
att_nbhd_convs_time0_3_3 (Conv2 (None, 64, 7, 7)     640         att_nbhd_volume_input_time_3_3[0]
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_1_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_1_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_1_3[0][0]   
__________________________________________________________________________________________________
nbhd_convs_activation_time0_1 ( (None, 64, 7, 7)     0           nbhd_convs_time0_1[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_2 ( (None, 64, 7, 7)     0           nbhd_convs_time0_2[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_3 ( (None, 64, 7, 7)     0           nbhd_convs_time0_3[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_4 ( (None, 64, 7, 7)     0           nbhd_convs_time0_4[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_5 ( (None, 64, 7, 7)     0           nbhd_convs_time0_5[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_6 ( (None, 64, 7, 7)     0           nbhd_convs_time0_6[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time0_7 ( (None, 64, 7, 7)     0           nbhd_convs_time0_7[0][0]         
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_2_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_2_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_2_3[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_3_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_3_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time0 (None, 64, 7, 7)     0           att_nbhd_convs_time0_3_3[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_time1_1_1 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_1
__________________________________________________________________________________________________
att_nbhd_convs_time1_1_2 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_1
__________________________________________________________________________________________________
att_nbhd_convs_time1_1_3 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_1
__________________________________________________________________________________________________
nbhd_convs_time1_1 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_1[0][
__________________________________________________________________________________________________
nbhd_convs_time1_2 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_2[0][
__________________________________________________________________________________________________
nbhd_convs_time1_3 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_3[0][
__________________________________________________________________________________________________
nbhd_convs_time1_4 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_4[0][
__________________________________________________________________________________________________
nbhd_convs_time1_5 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_5[0][
__________________________________________________________________________________________________
nbhd_convs_time1_6 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_6[0][
__________________________________________________________________________________________________
nbhd_convs_time1_7 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time0_7[0][
__________________________________________________________________________________________________
att_nbhd_convs_time1_2_1 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_2
__________________________________________________________________________________________________
att_nbhd_convs_time1_2_2 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_2
__________________________________________________________________________________________________
att_nbhd_convs_time1_2_3 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_2
__________________________________________________________________________________________________
att_nbhd_convs_time1_3_1 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_3
__________________________________________________________________________________________________
att_nbhd_convs_time1_3_2 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_3
__________________________________________________________________________________________________
att_nbhd_convs_time1_3_3 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time0_3
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_1_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_1_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_1_3[0][0]   
__________________________________________________________________________________________________
nbhd_convs_activation_time1_1 ( (None, 64, 7, 7)     0           nbhd_convs_time1_1[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_2 ( (None, 64, 7, 7)     0           nbhd_convs_time1_2[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_3 ( (None, 64, 7, 7)     0           nbhd_convs_time1_3[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_4 ( (None, 64, 7, 7)     0           nbhd_convs_time1_4[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_5 ( (None, 64, 7, 7)     0           nbhd_convs_time1_5[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_6 ( (None, 64, 7, 7)     0           nbhd_convs_time1_6[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time1_7 ( (None, 64, 7, 7)     0           nbhd_convs_time1_7[0][0]         
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_2_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_2_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_2_3[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_3_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_3_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time1 (None, 64, 7, 7)     0           att_nbhd_convs_time1_3_3[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_time2_1_1 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_1
__________________________________________________________________________________________________
att_nbhd_convs_time2_1_2 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_1
__________________________________________________________________________________________________
att_nbhd_convs_time2_1_3 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_1
__________________________________________________________________________________________________
nbhd_convs_time2_1 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_1[0][
__________________________________________________________________________________________________
nbhd_convs_time2_2 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_2[0][
__________________________________________________________________________________________________
nbhd_convs_time2_3 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_3[0][
__________________________________________________________________________________________________
nbhd_convs_time2_4 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_4[0][
__________________________________________________________________________________________________
nbhd_convs_time2_5 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_5[0][
__________________________________________________________________________________________________
nbhd_convs_time2_6 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_6[0][
__________________________________________________________________________________________________
nbhd_convs_time2_7 (Conv2D)     (None, 64, 7, 7)     36928       nbhd_convs_activation_time1_7[0][
__________________________________________________________________________________________________
att_nbhd_convs_time2_2_1 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_2
__________________________________________________________________________________________________
att_nbhd_convs_time2_2_2 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_2
__________________________________________________________________________________________________
att_nbhd_convs_time2_2_3 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_2
__________________________________________________________________________________________________
att_nbhd_convs_time2_3_1 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_3
__________________________________________________________________________________________________
att_nbhd_convs_time2_3_2 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_3
__________________________________________________________________________________________________
att_nbhd_convs_time2_3_3 (Conv2 (None, 64, 7, 7)     36928       att_nbhd_convs_activation_time1_3
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_1_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_1_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_1_3[0][0]   
__________________________________________________________________________________________________
nbhd_convs_activation_time2_1 ( (None, 64, 7, 7)     0           nbhd_convs_time2_1[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_2 ( (None, 64, 7, 7)     0           nbhd_convs_time2_2[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_3 ( (None, 64, 7, 7)     0           nbhd_convs_time2_3[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_4 ( (None, 64, 7, 7)     0           nbhd_convs_time2_4[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_5 ( (None, 64, 7, 7)     0           nbhd_convs_time2_5[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_6 ( (None, 64, 7, 7)     0           nbhd_convs_time2_6[0][0]         
__________________________________________________________________________________________________
nbhd_convs_activation_time2_7 ( (None, 64, 7, 7)     0           nbhd_convs_time2_7[0][0]         
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_2_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_2_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_2_3[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_3_1[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_3_2[0][0]   
__________________________________________________________________________________________________
att_nbhd_convs_activation_time2 (None, 64, 7, 7)     0           att_nbhd_convs_time2_3_3[0][0]   
__________________________________________________________________________________________________
att_nbhd_flatten_time_1_1 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_1
__________________________________________________________________________________________________
att_nbhd_flatten_time_1_2 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_1
__________________________________________________________________________________________________
att_nbhd_flatten_time_1_3 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_1
__________________________________________________________________________________________________
nbhd_flatten_time_1 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_1[0][
__________________________________________________________________________________________________
nbhd_flatten_time_2 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_2[0][
__________________________________________________________________________________________________
nbhd_flatten_time_3 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_3[0][
__________________________________________________________________________________________________
nbhd_flatten_time_4 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_4[0][
__________________________________________________________________________________________________
nbhd_flatten_time_5 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_5[0][
__________________________________________________________________________________________________
nbhd_flatten_time_6 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_6[0][
__________________________________________________________________________________________________
nbhd_flatten_time_7 (Flatten)   (None, 3136)         0           nbhd_convs_activation_time2_7[0][
__________________________________________________________________________________________________
att_nbhd_flatten_time_2_1 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_2
__________________________________________________________________________________________________
att_nbhd_flatten_time_2_2 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_2
__________________________________________________________________________________________________
att_nbhd_flatten_time_2_3 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_2
__________________________________________________________________________________________________
att_nbhd_flatten_time_3_1 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_3
__________________________________________________________________________________________________
att_nbhd_flatten_time_3_2 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_3
__________________________________________________________________________________________________
att_nbhd_flatten_time_3_3 (Flat (None, 3136)         0           att_nbhd_convs_activation_time2_3
__________________________________________________________________________________________________
att_nbhd_dense_time_1_1 (Dense) (None, 128)          401536      att_nbhd_flatten_time_1_1[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_1_2 (Dense) (None, 128)          401536      att_nbhd_flatten_time_1_2[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_1_3 (Dense) (None, 128)          401536      att_nbhd_flatten_time_1_3[0][0]  
__________________________________________________________________________________________________
nbhd_dense_time_1 (Dense)       (None, 128)          401536      nbhd_flatten_time_1[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_2 (Dense)       (None, 128)          401536      nbhd_flatten_time_2[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_3 (Dense)       (None, 128)          401536      nbhd_flatten_time_3[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_4 (Dense)       (None, 128)          401536      nbhd_flatten_time_4[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_5 (Dense)       (None, 128)          401536      nbhd_flatten_time_5[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_6 (Dense)       (None, 128)          401536      nbhd_flatten_time_6[0][0]        
__________________________________________________________________________________________________
nbhd_dense_time_7 (Dense)       (None, 128)          401536      nbhd_flatten_time_7[0][0]        
__________________________________________________________________________________________________
att_nbhd_dense_time_2_1 (Dense) (None, 128)          401536      att_nbhd_flatten_time_2_1[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_2_2 (Dense) (None, 128)          401536      att_nbhd_flatten_time_2_2[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_2_3 (Dense) (None, 128)          401536      att_nbhd_flatten_time_2_3[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_3_1 (Dense) (None, 128)          401536      att_nbhd_flatten_time_3_1[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_3_2 (Dense) (None, 128)          401536      att_nbhd_flatten_time_3_2[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_time_3_3 (Dense) (None, 128)          401536      att_nbhd_flatten_time_3_3[0][0]  
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_1_1[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_1_2[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_1_3[0][0]    
__________________________________________________________________________________________________
nbhd_dense_activation_time_1 (A (None, 128)          0           nbhd_dense_time_1[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_2 (A (None, 128)          0           nbhd_dense_time_2[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_3 (A (None, 128)          0           nbhd_dense_time_3[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_4 (A (None, 128)          0           nbhd_dense_time_4[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_5 (A (None, 128)          0           nbhd_dense_time_5[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_6 (A (None, 128)          0           nbhd_dense_time_6[0][0]          
__________________________________________________________________________________________________
nbhd_dense_activation_time_7 (A (None, 128)          0           nbhd_dense_time_7[0][0]          
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_2_1[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_2_2[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_2_3[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_3_1[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_3_2[0][0]    
__________________________________________________________________________________________________
att_nbhd_dense_activation_time_ (None, 128)          0           att_nbhd_dense_time_3_3[0][0]    
__________________________________________________________________________________________________
concatenate_3 (Concatenate)     (None, 384)          0           att_nbhd_dense_activation_time_1_
                                                                 att_nbhd_dense_activation_time_1_
                                                                 att_nbhd_dense_activation_time_1_
__________________________________________________________________________________________________
concatenate_1 (Concatenate)     (None, 896)          0           nbhd_dense_activation_time_1[0][0
                                                                 nbhd_dense_activation_time_2[0][0
                                                                 nbhd_dense_activation_time_3[0][0
                                                                 nbhd_dense_activation_time_4[0][0
                                                                 nbhd_dense_activation_time_5[0][0
                                                                 nbhd_dense_activation_time_6[0][0
                                                                 nbhd_dense_activation_time_7[0][0
__________________________________________________________________________________________________
concatenate_4 (Concatenate)     (None, 384)          0           att_nbhd_dense_activation_time_2_
                                                                 att_nbhd_dense_activation_time_2_
                                                                 att_nbhd_dense_activation_time_2_
__________________________________________________________________________________________________
concatenate_5 (Concatenate)     (None, 384)          0           att_nbhd_dense_activation_time_3_
                                                                 att_nbhd_dense_activation_time_3_
                                                                 att_nbhd_dense_activation_time_3_
__________________________________________________________________________________________________
att_lstm_input_1 (InputLayer)   (None, 3, 80)        0                                            
__________________________________________________________________________________________________
reshape_2 (Reshape)             (None, 3, 128)       0           concatenate_3[0][0]              
__________________________________________________________________________________________________
lstm_input (InputLayer)         (None, 7, 80)        0                                            
__________________________________________________________________________________________________
reshape_1 (Reshape)             (None, 7, 128)       0           concatenate_1[0][0]              
__________________________________________________________________________________________________
att_lstm_input_2 (InputLayer)   (None, 3, 80)        0                                            
__________________________________________________________________________________________________
reshape_3 (Reshape)             (None, 3, 128)       0           concatenate_4[0][0]              
__________________________________________________________________________________________________
att_lstm_input_3 (InputLayer)   (None, 3, 80)        0                                            
__________________________________________________________________________________________________
reshape_4 (Reshape)             (None, 3, 128)       0           concatenate_5[0][0]              
__________________________________________________________________________________________________
concatenate_6 (Concatenate)     (None, 3, 208)       0           att_lstm_input_1[0][0]           
                                                                 reshape_2[0][0]                  
__________________________________________________________________________________________________
concatenate_2 (Concatenate)     (None, 7, 208)       0           lstm_input[0][0]                 
                                                                 reshape_1[0][0]                  
__________________________________________________________________________________________________
concatenate_7 (Concatenate)     (None, 3, 208)       0           att_lstm_input_2[0][0]           
                                                                 reshape_3[0][0]                  
__________________________________________________________________________________________________
concatenate_8 (Concatenate)     (None, 3, 208)       0           att_lstm_input_3[0][0]           
                                                                 reshape_4[0][0]                  
__________________________________________________________________________________________________
att_lstm_1 (LSTM)               (None, 3, 128)       172544      concatenate_6[0][0]              
__________________________________________________________________________________________________
lstm_1 (LSTM)                   (None, 128)          172544      concatenate_2[0][0]              
__________________________________________________________________________________________________
att_lstm_2 (LSTM)               (None, 3, 128)       172544      concatenate_7[0][0]              
__________________________________________________________________________________________________
att_lstm_3 (LSTM)               (None, 3, 128)       172544      concatenate_8[0][0]              
__________________________________________________________________________________________________
attention_1 (Attention)         (None, 128)          32896       att_lstm_1[0][0]                 
                                                                 lstm_1[0][0]                     
__________________________________________________________________________________________________
attention_2 (Attention)         (None, 128)          32896       att_lstm_2[0][0]                 
                                                                 lstm_1[0][0]                     
__________________________________________________________________________________________________
attention_3 (Attention)         (None, 128)          32896       att_lstm_3[0][0]                 
                                                                 lstm_1[0][0]                     
__________________________________________________________________________________________________
concatenate_9 (Concatenate)     (None, 384)          0           attention_1[0][0]                
                                                                 attention_2[0][0]                
                                                                 attention_3[0][0]                
__________________________________________________________________________________________________
reshape_5 (Reshape)             (None, 3, 128)       0           concatenate_9[0][0]              
__________________________________________________________________________________________________
lstm_2 (LSTM)                   (None, 128)          131584      reshape_5[0][0]                  
__________________________________________________________________________________________________
concatenate_10 (Concatenate)    (None, 256)          0           lstm_2[0][0]                     
                                                                 lstm_1[0][0]                     
__________________________________________________________________________________________________
dense_1 (Dense)                 (None, 1)            257         concatenate_10[0][0]             
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 1)            0           dense_1[0][0]                    
==================================================================================================
Total params: 8,537,217
Trainable params: 8,537,217
Non-trainable params: 0
__________________________________________________________________________________________________
Train on 195993 samples, validate on 48999 samples
Epoch 1/100
195993/195993 [==============================] - 685s 3ms/step - loss: 0.0040 - val_loss: 0.0017
Epoch 2/100
195993/195993 [==============================] - 684s 3ms/step - loss: 0.0017 - val_loss: 0.0019
Epoch 3/100
195993/195993 [==============================] - 637s 3ms/step - loss: 0.0016 - val_loss: 0.0013
Epoch 4/100
195993/195993 [==============================] - 629s 3ms/step - loss: 0.0015 - val_loss: 0.0017
Epoch 5/100
195993/195993 [==============================] - 635s 3ms/step - loss: 0.0015 - val_loss: 0.0013
Epoch 6/100
195993/195993 [==============================] - 623s 3ms/step - loss: 0.0014 - val_loss: 0.0013
Epoch 7/100
195993/195993 [==============================] - 634s 3ms/step - loss: 0.0014 - val_loss: 0.0013
Epoch 8/100
195993/195993 [==============================] - 634s 3ms/step - loss: 0.0013 - val_loss: 0.0012
Epoch 9/100
195993/195993 [==============================] - 630s 3ms/step - loss: 0.0013 - val_loss: 0.0012
Epoch 10/100
195993/195993 [==============================] - 644s 3ms/step - loss: 0.0013 - val_loss: 0.0012
Epoch 11/100
195993/195993 [==============================] - 640s 3ms/step - loss: 0.0013 - val_loss: 0.0012
Epoch 12/100
195993/195993 [==============================] - 633s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 13/100
195993/195993 [==============================] - 642s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 14/100
195993/195993 [==============================] - 632s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 15/100
195993/195993 [==============================] - 643s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 16/100
195993/195993 [==============================] - 644s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 17/100
195993/195993 [==============================] - 631s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 18/100
195993/195993 [==============================] - 644s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 19/100
195993/195993 [==============================] - 627s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 20/100
195993/195993 [==============================] - 628s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 21/100
195993/195993 [==============================] - 639s 3ms/step - loss: 0.0012 - val_loss: 0.0015
Epoch 22/100
195993/195993 [==============================] - 635s 3ms/step - loss: 0.0012 - val_loss: 0.0012
Epoch 23/100
195993/195993 [==============================] - 646s 3ms/step - loss: 0.0011 - val_loss: 0.0012
Epoch 24/100
195993/195993 [==============================] - 646s 3ms/step - loss: 0.0011 - val_loss: 0.0012
1104 1440
Now sampling at 1200 timeslots.
Now sampling at 1300 timeslots.
Now sampling at 1400 timeslots.
min: 0.0 max: 281.0
(9, 86016, 1, 7, 7) (3, 86016, 3, 80) (7, 86016, 1, 7, 7) (86016, 7, 80) (86016, 1)
rmse (norm): 0.034112 rmse (real): 4.792694
